<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test Reports</title>
    <style>
        body { 
            font-family: Arial, sans-serif; 
            margin: 40px; 
            line-height: 1.6;
        }
        .header {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 8px;
            margin-bottom: 30px;
        }
        .report { 
            margin: 20px 0; 
            padding: 20px; 
            border: 1px solid #ddd; 
            border-radius: 8px;
            background: #fff;
        }
        .report:hover {
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }
        h1 { 
            color: #24292e; 
            margin: 0;
        }
        h2 { 
            color: #0366d6; 
            margin-top: 0;
        }
        ul {
            padding-left: 20px;
        }
        li {
            margin: 8px 0;
        }
        a { 
            color: #0366d6; 
            text-decoration: none; 
            font-weight: 500;
        }
        a:hover { 
            text-decoration: underline; 
        }
        .timestamp {
            color: #6a737d;
            font-size: 14px;
            margin-left: 10px;
        }
        .no-reports {
            text-align: center;
            color: #6a737d;
            padding: 40px;
            font-style: italic;
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>üöÄ Test Reports</h1>
        <p>Automated test execution reports and API coverage analysis</p>
    </div>

    <div id="reports-container">
        <div class="no-reports" id="loading-message">
            Loading reports...
        </div>
    </div>

    <script>
        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è —Å–ø–∏—Å–∫–∞ –ø—Ä–æ–≥–æ–Ω–æ–≤
        async function loadReports() {
            const container = document.getElementById('reports-container');
            const loadingMessage = document.getElementById('loading-message');
            
            try {
                // –ü–æ–ª—É—á–∞–µ–º —Å–ø–∏—Å–æ–∫ –≤—Å–µ—Ö –ø–∞–ø–æ–∫ –≤ test-report
                const reports = [];
                
                // –ò—â–µ–º –ø–∞–ø–∫–∏ —Å –Ω–æ–º–µ—Ä–∞–º–∏ –ø—Ä–æ–≥–æ–Ω–æ–≤ (—Ç–æ–ª—å–∫–æ —Ü–∏—Ñ—Ä—ã)
                const runFolders = [];
                for (let i = 1; i <= 1000; i++) { // –ü—Ä–µ–¥–ø–æ–ª–∞–≥–∞–µ–º –º–∞–∫—Å–∏–º—É–º 1000 –ø—Ä–æ–≥–æ–Ω–æ–≤
                    const folderPath = `test-report/${i}`;
                    try {
                        // –ü—Ä–æ–≤–µ—Ä—è–µ–º —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏–µ –ø–∞–ø–∫–∏ —á–µ—Ä–µ–∑ –ø–æ–ø—ã—Ç–∫—É –∑–∞–≥—Ä—É–∑–∫–∏ —Ñ–∞–π–ª–∞
                        const response = await fetch(`${folderPath}/allure-report/index.html`);
                        if (response.status === 200) {
                            runFolders.push(i);
                        }
                    } catch (e) {
                        // –ü–∞–ø–∫–∞ –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –∏–ª–∏ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–∞
                        continue;
                    }
                }
                
                // –°–æ—Ä—Ç–∏—Ä—É–µ–º –ø–æ —É–±—ã–≤–∞–Ω–∏—é (–Ω–æ–≤—ã–µ —Å–≤–µ—Ä—Ö—É)
                runFolders.sort((a, b) => b - a);
                
                if (runFolders.length === 0) {
                    loadingMessage.innerHTML = 'No test reports found.';
                    return;
                }
                
                loadingMessage.style.display = 'none';
                
                // –°–æ–∑–¥–∞–µ–º HTML –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –ø—Ä–æ–≥–æ–Ω–∞
                runFolders.forEach(runNumber => {
                    const reportDiv = document.createElement('div');
                    reportDiv.className = 'report';
                    reportDiv.innerHTML = `
                        <h2>Run #${runNumber}</h2>
                        <ul>
                            <li><a href="test-report/${runNumber}/allure-report/index.html" target="_blank">üìä Allure Test Report</a></li>
                            <li><a href="test-report/${runNumber}/swagger-coverage/swagger-coverage-report.html" target="_blank">üîç Swagger API Coverage Report</a></li>
                        </ul>
                    `;
                    container.appendChild(reportDiv);
                });
                
            } catch (error) {
                console.error('Error loading reports:', error);
                loadingMessage.innerHTML = 'Error loading reports. Please check if any test runs have completed.';
            }
        }

        // –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–π –≤–∞—Ä–∏–∞–Ω—Ç –¥–ª—è —Å—Ç–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è (–µ—Å–ª–∏ JavaScript –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç)
        function createStaticReports() {
            const container = document.getElementById('reports-container');
            container.innerHTML = `
                <div class="report">
                    <h2>Run #1</h2>
                    <ul>
                        <li><a href="test-report/1/allure-report/index.html" target="_blank">üìä Allure Test Report</a></li>
                        <li><a href="test-report/1/swagger-coverage/swagger-coverage-report.html" target="_blank">üîç Swagger API Coverage Report</a></li>
                    </ul>
                </div>
                <!-- –î–æ–±–∞–≤—å—Ç–µ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –ø—Ä–æ–≥–æ–Ω—ã –ø–æ –º–µ—Ä–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ -->
                <p><em>Note: This is a static view. For dynamic report loading, enable JavaScript.</em></p>
            `;
        }

        // –ó–∞–≥—Ä—É–∂–∞–µ–º –æ—Ç—á–µ—Ç—ã –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
        document.addEventListener('DOMContentLoaded', function() {
            loadReports();
            
            // Fallback –Ω–∞ —Å—Ç–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —á–µ—Ä–µ–∑ 3 —Å–µ–∫—É–Ω–¥—ã
            setTimeout(() => {
                if (document.querySelector('.report') === null) {
                    createStaticReports();
                }
            }, 3000);
        });
    </script>

    <noscript>
        <div class="report">
            <h2>Run #1</h2>
            <ul>
                <li><a href="test-report/1/allure-report/index.html">Allure Test Report</a></li>
                <li><a href="test-report/1/swagger-coverage/swagger-coverage-report.html">Swagger API Coverage Report</a></li>
            </ul>
        </div>
        <p><strong>JavaScript is disabled.</strong> Please enable JavaScript for automatic report discovery.</p>
    </noscript>

    <footer style="margin-top: 40px; padding-top: 20px; border-top: 1px solid #ddd; color: #6a737d; font-size: 14px;">
        <p>Generated automatically by GitHub Actions workflow</p>
    </footer>
</body>
</html>
